matrix:
  include:
    - language: go
      
      go:
        - "1.13.x"
      env:
        global:
          GO111MODULE=off
      
      before_install:
        - go get github.com/n-is/gopher-lua
        - go get github.com/n-is/tengo
        - go get github.com/axw/gocov/gocov
        - go get github.com/mattn/goveralls
        - if ! go get code.google.com/p/go.tools/cmd/cover; then go get golang.org/x/tools/cmd/cover; fi
        
      script:
        - go build ./...
        - go test -v -race -covermode atomic -coverprofile="profile.cov" ./...
        - $HOME/gopath/bin/goveralls -coverprofile="profile.cov" -service=travis-ci

    - language: python

      python: 3.7
      before_script:
        - python -m pip install --upgrade pip
        - pip install pytest
        - pip install pytest-benchmark
        - pip install pytest-cov
        - pip install python-coveralls
      
      script:
        - cd tests/scripts
        - pytest --cov=. --benchmark-skip
      
      after_success:
        - coveralls -d .coverage
